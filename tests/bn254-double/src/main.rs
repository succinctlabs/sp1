#![no_main]
sp1_zkvm::entrypoint!(main);

extern "C" {
    fn syscall_bn254_double(p: *mut u32);
}

pub fn main() {
    for _ in 0..10i64.pow(3) {
        // generator.
        // 1
        // 2
        let mut a: [u8; 64] = [
            1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0,
        ];

        unsafe {
            syscall_bn254_double(a.as_mut_ptr() as *mut u32);
        }

        // 2 * generator.
        // 1368015179489954701390400359078579693043519447331113978918064868415326638035
        // 9918110051302171585080402603319702774565515993150576347155970296011118125764
        let b: [u8; 64] = [
            211, 207, 135, 109, 193, 8, 194, 211, 168, 28, 135, 22, 169, 22, 120, 217, 133, 21, 24,
            104, 91, 4, 133, 155, 2, 26, 19, 46, 231, 68, 6, 3, 196, 162, 24, 90, 122, 191, 62,
            255, 199, 143, 83, 227, 73, 164, 166, 104, 10, 156, 174, 178, 150, 95, 132, 231, 146,
            124, 10, 14, 140, 115, 237, 21,
        ];

        assert_eq!(a, b);
    }

    println!("done");
}
